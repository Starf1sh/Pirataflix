

USE SENAI_PW;

CREATE TABLE CLIENTE(
    ID INT NOT NULL auto_increment,
    NOME VARCHAR(100) NOT NULL,
    IDADE SMALLINT NULL,
    CPF BIGINT NOT NULL UNIQUE,
    PRIMARY KEY(ID)
);

CREATE TABLE FUNCIONARIO(
    ID INT NOT NULL auto_increment,
    NOME VARCHAR(100) NOT NULL,
    CPF BIGINT NOT NULL UNIQUE,
    PRIMARY KEY(ID)
);

CREATE TABLE PRODUTO(
    ID INT NOT NULL auto_increment,
    NOME VARCHAR(100) NOT NULL,
    QUANTIDADE INT NULL DEFAULT 1,
    VALOR NUMERIC(9,2) NOT NULL,
    PRIMARY KEY(ID)
);

CREATE TABLE VENDA(
    ID INT NOT NULL auto_increment,
    ID_CLIENTE INT NOT NULL,
    ID_FUNCIONARIO INT NOT NULL,
    ID_PRODUTO INT NOT NULL,
    NOME_PRODUTO INT NOT NULL,
    QUANTIDADE INT NULL DEFAULT 1,
    VALOR NUMERIC(9,2) NOT NULL,
    data DATE default current_timestamp(),
    PRIMARY KEY(ID),
    CONSTRAINT FK_VENDA_CLIENTE FOREIGN KEY(ID_CLIENTE)
    REFERENCES CLIENTE(ID),
    CONSTRAINT FK_VENDA_ID_PRODUTO FOREIGN KEY(ID_PRODUTO)
    REFERENCES PRODUTO(ID),
    CONSTRAINT FK_VENDA_NOME_PRODUTO FOREIGN KEY(NOME_PRODUTO)
    REFERENCES PRODUTO(NOME),
    CONSTRAINT FK_VENDA_FUNCIONARIO FOREIGN KEY(ID_FUNCIONARIO)
    REFERENCES FUNCIONARIO(ID)
);

INSERT INTO CLIENTE
VALUES(0, 'DAVI', 25, 123456);
SELECT * FROM CLIENTE;

INSERT INTO PRODUTO
VALUES(0, 'CAMISA', 100, 35.50);

INSERT INTO PRODUTO
VALUES(0, 'GRAVATA', 100, 20.50);

SELECT * FROM PRODUTO;

INSERT INTO VENDA
VALUES(0, 1, 1, 2, '2023-03-15');
SELECT * FROM VENDA;

UPDATE CLIENTE
    SET NOME = 'DAVI SANTOS', IDADE = 29
    WHERE ID = 1;
SELECT * FROM CLIENTE;

DELETE FROM CLIENTE
WHERE ID = 2;

SELECT NOME, IDADE
FROM CLIENTE;

SELECT COUNT(*)
FROM CLIENTE
WHERE IDADE <= 35;

SELECT SUM(VALOR)
FROM PRODUTO;

SELECT NOME, MIN(VALOR)
FROM PRODUTO
GROUP BY NOME;

SELECT MAX(VALOR) AS 'MAIOR VALOR'
FROM PRODUTO;

SELECT AVG(VALOR) AS 'MEDIA'
FROM PRODUTO;

SELECT * FROM CLIENTE;

#>=
#<=
#>
#<
#<>
#=

SELECT (VALOR * 2) AS 'CALCULO'
FROM PRODUTO;

SELECT CLI.NOME AS 'CLIENTE', PRO.NOME AS 'PRODUTO',
       PRO.VALOR, VE.QUANTIDADE,
       (PRO.VALOR * VE.QUANTIDADE) AS 'TOTAL A PAGAR',
       VE.DATA
FROM VENDA VE
INNER JOIN CLIENTE CLI ON VE.ID_CLIENTE = CLI.ID
INNER JOIN PRODUTO PRO ON PRO.ID = VE.ID_PRODUTO
WHERE DATA between '2023-03-01' AND '2023-03-30';

SELECT CLI.NOME AS 'CLIENTE', PRO.NOME AS 'PRODUTO',
       PRO.VALOR, VE.QUANTIDADE,
       (PRO.VALOR * VE.QUANTIDADE) AS 'TOTAL A PAGAR'
FROM VENDA VE
INNER JOIN CLIENTE CLI ON VE.ID_CLIENTE = CLI.ID
INNER JOIN PRODUTO PRO ON PRO.ID = VE.ID_PRODUTO
WHERE MONTH(DATA) = 06;
